$(document).ready(function(){var e=document.querySelector("#dropper"),i=$(".hide").html(),n=-1;if(e){Dropzone.autoDiscover=!1;var a=new Dropzone("#dropper",{url:"/pin_images",maxFilesize:1,previewTemplate:i,paramName:function(e){return"pin_images["+e+"][photo]"},addRemoveLinks:!0,headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},autoProcessQueue:!1,uploadMultiple:!0,parallelUploads:100,maxFiles:10,init:function(){var e=document.querySelector("#submit-all");a=this,e.addEventListener("click",function(){a.processQueue()});var i=window.location.pathname;i.match(/\/pins\/\d*\/edit/)&&$.getJSON("pin_images.json",function(e){e&&e.forEach(function(e){a.addFile.call(a,e),a.options.thumbnail.call(a,e,e.url),$(e.previewElement).prop("id",e.id),$(e.previewElement).children("input").val(e.caption)})})}});a.on("success",function(e,i){var n=$("#pin_pin_image_ids");n.val(n.val()+","+i.id)}),a.on("addedfile",function(e){$(".dz-preview:last-child").attr("id","LM-"+e.lastModified)}),a.on("sending",function(e,i,a){n+=1,a.append("pin_images["+n+"]caption",$("#LM-"+e.lastModified+" .caption").val())})}});